<?php require_once "Mobile_Detect.php";$mobileDetect=new Mobile_Detect;$isMobile=0;if($mobileDetect->isTablet()){$isMobile^=1;$isMobile<<=1;}if($mobileDetect->isMobile()){$isMobile^=1;}session_start();if(!isset($_SESSION['myvar'])){$badbot=0;$useragent=$_SERVER['HTTP_USER_AGENT'];$proxy_headers=array('HTTP_VIA','HTTP_X_FORWARDED_FOR','HTTP_FORWARDED_FOR','HTTP_X_FORWARDED','HTTP_FORWARDED','HTTP_CLIENT_IP','HTTP_FORWARDED_FOR_IP','VIA','X_FORWARDED_FOR','FORWARDED_FOR','X_FORWARDED','FORWARDED','CLIENT_IP','FORWARDED_FOR_IP','HTTP_PROXY_CONNECTION');$thisIP=$_SERVER['REMOTE_ADDR'];$filename="blacklist.txt";$fp;if(file_exists($filename)){$fp=fopen($filename,'r')or die("Error opening file ... <br>\n");while(!feof($fp)){$line=fgets($fp,255);$u=explode(" ",$line);$u0=$u[0];if($u0==$thisIP){$badbot++;fseek($fp,0,SEEK_END);}}}else $fp=fopen($filename,'w')or die("Error creating file ... <br>\n");fclose($fp);if($badbot>0){header('Location: bot-trap/banned.php');}elseif((isset($_COOKIE['notabot'])&&$_COOKIE['notabot']=='true')||$isMobile){}elseif(in_array($_SERVER['REMOTE_PORT'],array(8080,80,6588,8000,3128,553,554))){header('Location: blocked.php?for=proxy&badremoteport='.$_SERVER['REMOTE_PORT'].'&page='.$_SERVER['PHP_SELF']);}else{}}$_SESSION['myvar']=True;?>