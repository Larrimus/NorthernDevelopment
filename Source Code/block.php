<?
//$blocked = ["<a href='blocked.dat'/>"]; // array list or from database
/*array(
	'173.234.143.137', // IP in the form of "127.0.0.1" or whatever
	'91.218.245.157',
	'173.234.142.48',
	'173.234.142.88',
	'116.255.143.115',
	'141.105.65.176',
	'110.34.172.58',
	'192.162.100.47',
	'192.162.19.183',
	'31.172.246.234',
	'93.174.93.85',
	'50.68.18.250',
	'2.94.72.132',
	'91.236.74.152',
	'88.190.36.136',
	'91.228.39.119',
	'218.6.8.19',
	'77.37.239.231',
	'120.32.230.84',
	'218.9.55.116',
	'27.159.211.34',
	'93.182.148.132',
	'146.0.74.239',
	'146.0.74.164',
	'27.159.197.211',
	'173.234.143.133',
	'188.143.232.195',
	'91.207.6.174',
	'188.143.232.197',
	'188.143.232.172',
	'46.17.97.139',
	'188.143.232.30',
	'188.143.232.44',
	'208.66.75.162',
	'91.207.5.134',
	'46.17.96.124',
	'173.245.90.143',
	'188.143.232.10',
	'108.62.130.50',
	'199.15.234.82',
	'108.62.180.33',
	'199.168.142.166',
	'46.17.96.85',
	'149.169.123.197',
	'173.245.53.156',
	'24.23.187.100',
	'91.207.5.206',
	'46.17.97.128',
	'199.15.234.64',
	'108.62.24.22',
	'108.177.138.248',
	'173.234.28.37',
	'23.19.152.211',
	'91.207.5.126',
	'91.210.105.223',
	'91.207.5.174',
	'184.154.140.204',
	'91.207.4.190',
	'46.17.96.27',
	'173.234.142.67',
	'108.62.130.136',
	'173.234.153.100',
	'46.17.98.190',
	'23.19.152.113',
	'108.62.202.51',
	'199.15.234.216',
	'206.72.201.73',
	'144.70.2.130',
	'46.17.99.33',
	'108.62.130.48',
	'96.9.138.134',
	'188.143.232.23',
	'72.46.128.10',
	'24.9.183.151',
	'69.166.65.190',
	'23.19.37.45',
	'108.21.103.51',
	'74.207.232.68',
	'66.197.231.135',
	'199.15.234.115',
	'46.17.97.235',
	'173.208.46.88',
	'173.245.51.113',
	'173.234.153.67',
	'23.19.213.197',
	'216.24.199.58',
	'46.17.102.13',
	'63.141.242.226',
	'46.17.101.107',
	'108.62.126.201',
	'188.143.232.108',
	'188.143.232.196',
	'173.160.74.252',
	'174.34.170.152',
	'108.62.146.20',
	'184.82.57.175',
	'109.230.244.126',
	'109.200.6.235',
	'91.210.104.143',
	'23.19.153.24',
	'108.177.139.122',
	'173.208.126.56',
	'108.62.88.26',
	'108.62.130.250',
	'69.147.240.239',
	'46.17.96.220',
	'91.207.6.118',
	'216.24.199.62',
	'23.19.143.80',
	'69.46.82.235',
	'173.208.8.74',
	'173.234.47.199',
	'173.234.249.31',
	'173.44.37.234',
	'12.68.249.130',
	'173.44.37.242',
	'173.245.49.162',
	'108.62.84.71',
	'108.62.24.25',
	'173.245.53.186',
	'108.62.83.218',
	'98.126.36.26',
	'173.245.53.145',
	'173.234.252.57',
	'69.147.249.72',
	'173.234.165.185',
	'173.44.37.250',
	'23.19.153.21',
	'174.128.235.162',
	'173.44.37.226',
	'108.62.127.117',
	'173.234.19.213',
	'69.162.159.21',
	'144.36.248.125',
	'108.62.88.55',
	'173.245.51.138',
	'173.208.50.26',
	'108.62.147.142',
	'173.245.90.56',
	'173.208.103.202',
	'65.32.250.7',
	'108.62.82.207',
	'173.234.38.100',
	'108.62.220.203',
	'107.22.50.230',
	'173.234.143.21',
	'173.234.30.31',
	'23.19.34.54',
	'199.15.234.76',
	'216.151.191.181',
	'96.47.225.178',
	'174.128.229.100',
	'199.59.62.76',
	'50.129.225.167',
	'69.147.240.105',
	'24.12.239.53',
	'174.36.213.169',
	'216.151.183.133',
	'173.245.49.174',
	'75.125.220.173',
	'199.15.234.66',
	'173.234.143.33',
	'173.245.64.10',
	'24.34.167.158',
	'173.234.219.32',
	'74.193.181.158',
	'184.154.66.17',
	'50.131.209.240',
	'173.234.143.144',
	'108.219.245.147',
	'96.47.224.42',
	'96.47.224.50',
	'96.47.224.58',
	'184.82.142.200',
	'108.62.53.122',
	'23.19.105.177',
	'184.98.176.43',
	'71.59.199.117',
	'173.245.53.167',
	'173.234.153.228',
	'46.22.78.213',
	'173.208.95.67',
	'23.19.34.208',
	'173.245.48.174',
	'173.234.142.84',
	'208.66.72.114',
	'173.245.50.180',
	'23.20.12.183',
	'23.19.34.78',
	'173.245.53.178',
	'50.31.10.67',
	'69.162.159.210',
	'69.162.159.249',
	'108.62.84.182',
	'23.19.105.82',
	'23.19.105.102',
	'50.31.10.103',
	'173.208.70.56',
	'109.169.84.127',
	'76.25.1.171',
	'69.22.185.26',
	'173.234.219.79',
	'188.143.232.25',
	'108.62.195.223',
	'72.9.107.180',
	'173.208.39.176',
	'23.19.143.220',
	'173.234.242.114',
	'173.234.177.38',
	'173.234.138.152',
	'173.208.95.135',
	'108.62.151.68',
	'173.234.48.125',
	'173.208.70.214',
	'173.208.94.186',
	'108.62.150.86',
	'108.62.173.254',
	'23.19.34.101',
	'173.208.71.190',
	'173.234.49.108',
	'199.15.234.104',
	'184.22.6.184',
	'199.19.109.246',
	'173.234.225.5',
	'173.208.204.202',
	'173.234.174.144',
	'184.22.6.188',
	'173.234.245.39',
	'173.208.95.143',
	'184.22.6.167',
	'184.22.6.168',
	'184.22.6.170',
	'173.234.210.111',
	'173.234.19.75',
	'184.22.6.173',
	'108.62.83.4',
	'184.22.6.176',
	'184.22.6.177',
	'184.22.6.183',
	'184.22.6.185',
	'173.234.158.83',
	'184.22.6.186',
	'173.208.39.233',
	'173.242.114.92',
	'76.125.226.161',
	'173.234.159.85',
	'173.234.210.41',
	'184.22.6.164',
	'108.62.56.64',
	'173.208.67.38',
	'199.27.128.213',
	'173.208.95.26',
	'184.22.6.178',
	'173.208.91.96',
	'184.22.6.180',
	'173.234.18.25',
	'184.22.6.163',
	'23.19.34.162',
	'108.62.64.26',
	'108.62.64.29',
	'108.62.64.30',
	'184.22.6.174',
	'184.22.6.172',
	'184.22.6.190',
	'184.22.6.165',
	'173.234.52.101',
	'107.20.164.163',
	'184.22.6.187',
	'199.19.104.197',
	'173.234.47.77',
	'173.234.252.38',
	'173.234.174.71',
	'173.234.229.47',
	'69.147.248.20',
	'173.208.91.18',
	'69.194.161.228',
	'184.22.6.179',
	'173.208.71.56',
	'108.62.130.199',
	'173.234.174.193',
	'50.22.104.219',
	'173.208.24.17',
	'173.234.169.30',
	'173.234.169.27',
	'69.162.159.77',
	'69.162.159.109',
	'23.19.86.26',
	'23.19.207.91',
	'173.208.209.245',
	'199.15.234.15',
	'50.31.10.24',
	'184.22.6.182',
	'199.192.157.228',
	'69.162.159.89',
	'173.234.31.47',
	'108.62.64.27',
	'173.234.169.26',
	'173.234.169.28',
	'108.62.64.28',
	'173.234.169.29',
	'69.162.159.108',
	'23.19.152.44',
	'204.124.180.74',
	'23.19.207.117',
	'173.208.37.78',
	'23.19.204.71',
	'108.62.45.91',
	'184.22.6.169',
	'199.15.234.2',
	'173.234.238.134',
	'173.245.95.171',
	'173.234.188.48',
	'199.168.139.204',
	'108.62.127.123',
	'199.15.234.113',
	'173.234.252.43',
	'173.224.222.166',
	'173.208.14.20',
	'72.64.146.136',
	'173.242.115.176',
	'108.62.24.23',
	'216.255.86.24',
	'108.62.180.52',
	'173.234.219.99',
	'173.208.19.30',
	'23.19.153.23',
	'184.22.240.24',
	'173.245.51.130',
	'173.208.18.97',
	'173.234.46.53',
	'173.234.188.155',
	'216.118.70.2',
	'108.62.127.60',
);*/
$allowed = array(
	'',
);
$proxy_headers = array(
	'HTTP_VIA',
	'HTTP_X_FORWARDED_FOR',
	'HTTP_FORWARDED_FOR',
	'HTTP_X_FORWARDED',
	'HTTP_FORWARDED',
	'HTTP_CLIENT_IP',
	'HTTP_FORWARDED_FOR_IP',
	'VIA',
	'X_FORWARDED_FOR',
	'FORWARDED_FOR',
	'X_FORWARDED',
	'FORWARDED',
	'CLIENT_IP',
	'FORWARDED_FOR_IP',
	'HTTP_PROXY_CONNECTION'
);


// add as many as you wish
if ($_COOKIE['notabot'] == 'true' || in_array($_SERVER['REMOTE_ADDR'],$allowed))
{
	
}
elseif ((in_array(getIP(), $blocked)) || (in_array(getIP(), $blacklist)))
{
	header('Location: bot-trap/banned.php');
}
elseif (in_array($_SERVER['REMOTE_PORT'], array(8080,80,6588,8000,3128,553,554))/* || @fsockopen($_SERVER['REMOTE_ADDR'], $port, $errno, $errstr, 1) || getenv('HTTP_X_FORWARDED_FOR') || isset($_SERVER['HTTP_VIA'])*/)
{
    header('Location: blocked.php?for=proxy');
}
else{
	foreach($proxy_headers as $x){
        if (isset($_SERVER[$x]))
		{
			header('Location: blocked.php?for=proxy');
		}
    }
}
?>